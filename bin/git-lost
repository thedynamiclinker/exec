#!/usr/bin/env bash

[[ -z "$1" ]] && {
    echo "usage: $(basename "$0") <regex>"
    exit 1
}

regex="$1"

git rev-list HEAD | while read commit; do

    git ls-tree -r "$commit" | grep "$regex" | while read line; do

        printf "commit:${commit}\t${line}\n"

    done

done
