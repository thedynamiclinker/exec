#!/usr/bin/env python

import sys
import pickle

LOADERS = [pickle.load]

try:
    import pandas
    LOADERS.append(pandas.compat.pickle_compat.load)
except:
    pass


def try_load(fp):
    exceptions = []
    for loader in LOADERS:
        try:
            return loader(fp)
        except Exception as e:
            pass
    else:
        print(f"Hey you got some exceptions...")
        for n, e in enumerate(exceptions):
            print(f" * exception {n}: {e!r}")
        raise Exception("See above")


if len(sys.argv) > 1:
    filenames = sys.argv[1:]
    fps = [open(filename, 'rb') for filename in filenames]
else:
    fps = [sys.stdin]

for fp in fps:
    with fp:
        print(try_load(fp))
