#!/usr/bin/env bash

# note: orgs can be treated as users, but not
# vice-versa, so this works for orgs as well

if [[ -z $1 ]]; then
    query="user/repos"
else
    name="$1"
    query="users/$name/repos"
fi

gh api "$query" --paginate | jq -r '.[].full_name'

# to exclude repos that the user has been added to
# as a collaborator but doesn't either own or belong
# to an organization that owns, do this:
# gh api "$query" --paginate | jq -r --arg self $(gh api user --jq '.login') '.[] | select(.owner.login == $self or .owner.type == "Organization") | .full_name'
